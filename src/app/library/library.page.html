<ion-header class="ion-no-border">
  <ion-toolbar color="transparent">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Mi Tesoro üíé</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" [scrollY]="true">
  <!-- Empty State -->
  <div *ngIf="favorites.length === 0" class="empty-state">
    <ion-icon name="musical-notes"></ion-icon>
    <h3>Tu cofre est√° vac√≠o</h3>
    <p>Agrega canciones desde la secci√≥n de M√∫sica</p>
  </div>

  <!-- Favorites List -->
  <div class="favorites-container" *ngIf="favorites.length > 0">
    <div class="favorites-header">
      <h2>{{ favorites.length }} canci√≥n{{ favorites.length !== 1 ? 'es' : '' }}</h2>
    </div>

    <ion-list lines="none" class="track-list">
      <ion-item *ngFor="let track of favorites; let i = index" class="track-item"
        [class.playing]="(currentTrack$ | async)?.id === track.id" [class.no-preview]="!hasPreview(track)"
        (click)="hasPreview(track) ? togglePlay(track) : null">

        <!-- Track Number / Play Indicator -->
        <div slot="start" class="track-number">
          <span *ngIf="(currentTrack$ | async)?.id !== track.id" class="number">{{ i + 1 }}</span>
          <ion-icon *ngIf="(currentTrack$ | async)?.id === track.id && (isPlaying$ | async)" name="pause" class="playing-icon"></ion-icon>
          <ion-icon *ngIf="(currentTrack$ | async)?.id === track.id && !(isPlaying$ | async)" name="play" class="playing-icon"></ion-icon>
        </div>

        <!-- Album Art -->
        <ion-thumbnail slot="start" class="album-art">
          <img [src]="getAlbumCover(track)" [alt]="track.title || 'Album cover'" title="Album cover" (error)="onImageError($event)">
          <div class="play-overlay">
            <ion-icon name="play-circle"></ion-icon>
          </div>
        </ion-thumbnail>

        <!-- Track Info -->
        <ion-label class="track-info">
          <h3 class="track-title">{{ track.title || track.name || 'Sin t√≠tulo' }}</h3>
          <p class="track-artist">{{ getArtistName(track) }}</p>
        </ion-label>

        <!-- Actions -->
        <div slot="end" class="actions">
          <span class="duration" *ngIf="track.duration">{{ formatDuration(track.duration) }}</span>
          <ion-badge color="medium" *ngIf="!hasPreview(track)">Sin preview</ion-badge>
          <ion-button fill="clear" (click)="removeFavorite($event, track)" class="delete-btn">
            <ion-icon name="trash-outline"></ion-icon>
          </ion-button>
        </div>
      </ion-item>
    </ion-list>
  </div>
</ion-content>
